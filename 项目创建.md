# 七牛云3D模型生成应用 - 安装指南

## 环境要求

根据项目的pom.xml文件和README.md，该项目需要以下环境：

- **JDK版本**：Java 8+（推荐Java 8）
- **Maven版本**：Maven 3.6+
- **数据库**：MySQL 8.0+
- **缓存**：Redis 6.0+

## 安装步骤

### 1. 安装Java Development Kit (JDK)

#### Windows系统：

1. 访问Oracle JDK下载页面或OpenJDK下载页面
   - Oracle JDK: https://www.oracle.com/java/technologies/downloads/
   - OpenJDK: https://adoptium.net/

2. 下载适合您系统的JDK 8安装包

3. 运行安装程序并按照提示完成安装

4. 配置环境变量：
   - 右键点击"此电脑" > "属性" > "高级系统设置" > "环境变量"
   - 在"系统变量"中新建变量 `JAVA_HOME`，值为JDK的安装路径（例如：`C:\Program Files\Java\jdk1.8.0_301`）
   - 编辑"系统变量"中的 `Path` 变量，添加 `%JAVA_HOME%\bin`

5. 验证安装：打开命令提示符，输入 `java -version`，应该显示Java版本信息

#### Linux系统：

```bash
# 使用apt安装OpenJDK 8
sudo apt update
sudo apt install openjdk-8-jdk

# 验证安装
java -version
```

### 2. 安装Apache Maven

#### Windows系统：

1. 访问Maven下载页面：https://maven.apache.org/download.cgi

2. 下载最新的二进制zip归档文件（例如：apache-maven-3.9.6-bin.zip）

3. 解压下载的文件到您选择的目录（例如：`C:\Program Files\Apache\Maven`）

4. 配置环境变量：
   - 右键点击"此电脑" > "属性" > "高级系统设置" > "环境变量"
   - 在"系统变量"中新建变量 `MAVEN_HOME`，值为Maven的安装路径
   - 编辑"系统变量"中的 `Path` 变量，添加 `%MAVEN_HOME%\bin`

5. 验证安装：打开命令提示符，输入 `mvn -version`，应该显示Maven版本信息

#### Linux系统：

```bash
# 下载Maven
sudo wget https://dlcdn.apache.org/maven/maven-3/3.9.6/binaries/apache-maven-3.9.6-bin.tar.gz

# 解压到/opt目录
sudo tar -xvzf apache-maven-3.9.6-bin.tar.gz -C /opt

# 创建软链接
sudo ln -s /opt/apache-maven-3.9.6 /opt/maven

# 配置环境变量
echo 'export M2_HOME=/opt/maven' | sudo tee -a /etc/profile
echo 'export PATH=${M2_HOME}/bin:${PATH}' | sudo tee -a /etc/profile

source /etc/profile

# 验证安装
mvn -version
### 3. 安装MySQL 8.0+

#### Windows系统：

1. 访问MySQL官方下载页面：https://dev.mysql.com/downloads/installer/

2. 下载MySQL Installer for Windows（推荐下载完整版本）

3. 运行安装程序并按照提示完成安装
   - 选择"Developer Default"或"Server Only"安装类型
   - 设置root用户密码
   - 记住您设置的密码，后续配置时会用到

4. 配置环境变量：
   - 右键点击"此电脑" > "属性" > "高级系统设置" > "环境变量"
   - 在"系统变量"中编辑`Path`变量
   - 添加MySQL的bin目录路径（例如：`C:\Program Files\MySQL\MySQL Server 8.0\bin`）

5. 验证安装：打开命令提示符，输入 `mysql -u root -p`，然后输入您设置的密码，如果能成功登录MySQL命令行界面，则表示安装成功

#### Linux系统：

```bash
# 更新软件包列表
sudo apt update

# 安装MySQL服务器
sudo apt install mysql-server

# 启动MySQL服务
sudo systemctl start mysql

# 设置MySQL服务开机自启
sudo systemctl enable mysql

# 运行安全脚本设置root密码和安全选项
sudo mysql_secure_installation

# 验证安装
sudo mysql -u root -p
```

### 4. 安装Redis 6.0+

请参考Redis官方文档进行安装：https://redis.io/docs/getting-started/

### 5. 安装项目依赖

当您安装好Java和Maven后，可以按照以下步骤安装项目依赖：

1. 打开命令提示符或终端

2. 导航到项目根目录：
   ```bash
   cd d:\用户\七牛_project_01\qianniu-3d-generator
   ```

3. 执行Maven命令安装依赖：
   ```bash
   mvn clean install
   ```

   这个命令会下载项目所需的所有依赖并安装到本地Maven仓库。

### 6. 数据库初始化

在启动应用前，需要初始化数据库：

```bash
# 执行数据库初始化脚本
Get-Content docs/database/init.sql | mysql -u root -p
```

### 7. 配置应用

修改 `qiniu-3d-generator-app/src/main/resources/application.yml` 文件，更新数据库和Redis连接信息：

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/qiniu_3d_generator
    username: your_username
    password: your_password
  redis:
    host: localhost
    port: 6379
    password: your_redis_password

# 第三方API配置
meshy:
  api:
    base-url: https://api.meshy.ai
    api-key: your_meshy_api_key
```

## 启动应用

安装完所有依赖并配置好环境后，可以启动应用。

**重要提示**：由于这是一个多模块项目，在首次运行前，需要先构建所有模块：

```bash
# 确保在项目根目录执行命令
d:\用户\七牛_project_01\qianniu-3d-generator

# 首先构建所有模块（这会解决依赖解析错误）
mvn clean install

# 然后执行启动命令
mvn spring-boot:run -pl qiniu-3d-generator-app
```

应用启动后，可以访问：
- **应用地址**：http://localhost:8080
- **API文档**：http://localhost:8080/swagger-ui/index.html
- **健康检查**：http://localhost:8080/api/generation/health

## 常见问题

1. **Maven依赖下载缓慢**：可以配置Maven使用国内镜像源
   ```xml
   <!-- 在~/.m2/settings.xml文件中添加 -->
   <mirrors>
     <mirror>
       <id>aliyun-maven</id>
       <mirrorOf>central</mirrorOf>
       <name>阿里云Maven镜像</name>
       <url>https://maven.aliyun.com/repository/public</url>
     </mirror>
   </mirrors>
   ```

2. **"Could not find the selected project in the reactor"错误**：确保在正确的目录下执行命令。请导航到 `d:\用户\七牛_project_01\qianniu-3d-generator` 目录，然后再执行启动命令。这是因为Maven需要在包含所有模块的根目录下识别项目结构。

3. **"Could not resolve dependencies"错误**：如果遇到找不到infrastructure或trigger模块的依赖错误，这是因为这是一个多模块项目，需要先在根目录执行 `mvn clean install` 构建所有模块，生成本地仓库中的依赖构件。这是首次运行或修改代码后必须执行的步骤。

4. **端口冲突**：如果8080端口已被占用，可以在application.yml中修改server.port配置

5. **数据库连接失败**：确保MySQL服务已启动，且用户名密码正确，并且已创建名为qiniu_3d_generator的数据库

如果您在安装过程中遇到其他问题，请参考项目中的README.md文件或联系项目维护者。
